<script setup lang="ts">
import { ref, onMounted, onUnmounted } from 'vue'
import ContainerComponent from '@/components/layout/ContainerComponent.vue'
import { useModalStore } from '@/stores/modal'

const mobileMenuIsOpen = ref<boolean>(false)
const isWhiteHeader = ref<boolean>(false)

const modalStore = useModalStore()

const toggleMobileMenu = () => {
    mobileMenuIsOpen.value = !mobileMenuIsOpen.value
}

const resizeHandler = () => {
    if (window.innerWidth > 575) {
        mobileMenuIsOpen.value = false
    }
}

const scrollHandler = () => {
    if (mobileMenuIsOpen.value) {
        mobileMenuIsOpen.value = false
    }

    isWhiteHeader.value = window.scrollY !== 0;

    if(isWhiteHeader.value) {
        modalStore.setIsInfoShow(true)
    } else {
        modalStore.setIsInfoShow(false)
    }
}

const inDev = () => {
    alert("Личный кабинет в разработке")
}

onMounted(() => {
    resizeHandler()
    window.addEventListener('resize', resizeHandler, { passive: true })
    window.addEventListener('scroll', scrollHandler, { passive: true })
})

onUnmounted(() => {
    resizeHandler()
    window.removeEventListener('resize', resizeHandler)
    window.removeEventListener('scroll', scrollHandler)
})
</script>
<template>
    <header :class="isWhiteHeader ? 'black' : ''" class="header">
        <ContainerComponent>
            <NuxtLink to="/">
                <svg class="logo white" viewBox="0 0 955 1187" fill="none"> <path d="M877 313.5C877 355.198 842.078 389 799 389C755.922 389 721 355.198 721 313.5C721 271.803 755.922 238 799 238C842.078 238 877 271.803 877 313.5Z" fill="black"/> <path d="M757 138.5C757 214.439 694.768 276 618 276C541.232 276 479 214.439 479 138.5C479 62.5609 541.232 1 618 1C694.768 1 757 62.5609 757 138.5Z" fill="black"/> <path fill-rule="evenodd" clip-rule="evenodd" d="M2.11145 582.317C2.11145 582.317 -0.389311 538.931 2.11145 511.317C33.1434 168.651 522.129 145.413 677.111 418.817C691.611 412.817 706.111 413.317 706.111 413.317C706.111 413.317 720.56 413.674 729.111 414.817C917.074 439.93 997.465 728.197 850.611 884.956C773.158 967.633 670.47 1020.84 570.822 1072.47C563.886 1076.06 556.964 1079.65 550.067 1083.24L550.057 1083.24L550.053 1083.25C538.032 1089.5 525.757 1095.19 513.476 1100.88L513.462 1100.89C508.507 1103.18 503.552 1105.48 498.611 1107.82L497.384 1108.4C473.57 1119.65 448.91 1128.87 424.241 1138.09L424.239 1138.09C408.46 1143.99 392.678 1149.88 377.111 1156.32C377.111 1156.32 379.107 1163.86 379.611 1168.82C380.146 1174.06 380.611 1179.82 379.611 1182.32C378.611 1184.82 376.646 1186.06 374.111 1185.82C370.877 1185.51 368.611 1179.32 368.611 1179.32C368.611 1179.32 359.644 1158.39 350.111 1148.82C334.309 1132.94 318.55 1117.36 302.952 1101.93C152.288 952.923 16.6646 818.79 2.11145 582.317ZM191 397C304.858 287.982 511.527 326.666 579.111 468.317C543.807 497.464 512.998 530.824 496.722 574.347L496.473 575.016C488.764 595.726 464.907 578.273 444.721 563.505C436.061 557.17 428.077 551.329 422.333 549.208C365.081 528.061 306.668 555.888 276.111 605.456C265.171 623.202 262.039 635.045 256.809 654.82L256.473 656.092C256.353 656.543 256.233 656.997 256.111 657.456C250.028 680.406 249.782 694.216 250.111 717.956C250.401 738.784 256.111 770.956 256.111 770.956C278.142 844.399 327.447 900.06 386.611 947.456C404.251 938.701 422.345 931.1 440.416 923.509C471.87 910.296 503.251 897.115 532.027 877.93C572.761 851.885 605.71 819.769 632.854 779.443L633.611 778.317C677.017 713.843 700.08 641.931 701.111 563.817V554.317C729.991 551.145 756.339 568.329 777.735 585.743L778.611 586.456C800.415 604.191 813.186 630.252 818.611 657.456C826.222 695.616 825.376 731.209 813.89 768.415L813.611 769.317C764.848 927.317 578.638 1014.67 434.746 1082.18C427.072 1085.78 419.518 1089.32 412.111 1092.82C412.111 1092.82 391.19 1100.79 377.111 1102.46C377.111 1102.46 331.293 1059.1 305.611 1025.82C194.313 881.553 107.907 683.449 138.5 499C144.25 464.33 165.129 421.771 191 397ZM254.824 992.486C265.765 1003.16 276.097 1013.24 285.111 1025.82C180.822 879.007 107.002 706.982 123 523.485C125.52 494.577 127.821 488.007 136.332 463.704C137.013 461.756 137.735 459.695 138.5 457.5C186.956 318.418 375.94 286.922 490.611 357.317C517.054 373.55 539.143 391.371 562.111 420.817C573.404 435.295 588.111 461.317 588.111 461.317C588.111 461.317 596.14 454.294 610.111 446.817C613.394 445.06 616.955 442.957 620.71 440.739C626.94 437.06 633.703 433.066 640.611 429.817C645.637 427.454 650.919 425.634 655.47 424.066C658.908 422.882 661.93 421.841 664.111 420.817C523.324 165.783 104.863 223.431 86.6401 523.485L86.6115 523.956C80.6017 622.898 94.3234 713.513 134.111 803.817C134.111 803.817 145.62 828.849 150.111 840.956C150.111 840.956 189.602 916.083 223.111 958.456C233.829 972.007 244.593 982.506 254.824 992.486ZM598.5 576.5L596.5 568.5C558.048 576.158 524.408 594.635 500.5 625.5C495.023 632.571 492 638.5 492 638.5C492 638.5 486.578 649.386 480 651.5C474.288 653.336 467.913 654.915 462.5 651.5C453.603 645.887 445.089 638.016 436.601 630.168C412.944 608.298 389.487 586.612 358.5 614.5C313.38 655.108 315.594 744.766 342.5 797C355.924 823.062 382.07 846.692 403.5 866C525.409 834.329 630.468 706.855 598.5 576.5Z" fill="black"/> <path d="M804 421.5L835.5 441.5L841 432.5L810 413L804 421.5Z" fill="#0E0000"/> <path d="M660.5 396.076H712.822L712.709 385.529L656 385.529L660.5 396.076Z" fill="#0E0000"/> <path d="M898.78 508.414L916.477 541.263L925.676 536.102L908.17 503.934L898.78 508.414Z" fill="#0E0000"/> <path d="M925.258 561.364L935.585 597.219L945.669 594.127L935.384 558.977L925.258 561.364Z" fill="#0E0000"/> <path d="M938.45 617.398L943.003 654.432L953.448 652.965L948.826 616.635L938.45 617.398Z" fill="#0E0000"/> <path d="M942.848 674.296L943.195 711.607L953.738 711.328L953.244 674.708L942.848 674.296Z" fill="#0E0000"/> <path d="M941.587 730.139L934.631 766.797L945.026 768.586L951.701 732.576L941.587 730.139Z" fill="#0E0000"/> <path d="M931.73 786.392L917.157 820.741L926.936 824.693L941.098 790.919L931.73 786.392Z" fill="#0E0000"/> <path d="M908.997 839.146L889.543 870.986L898.636 876.33L917.599 844.999L908.997 839.146Z" fill="#0E0000"/> <path d="M877.482 888.093L852.851 916.121L860.892 922.947L884.952 895.336L877.482 888.093Z" fill="#0E0000"/> <path d="M835.914 933.029L806.769 956.327L813.495 964.452L842.005 941.464L835.914 933.029Z" fill="#0E0000"/> <path d="M789.662 969.923L758.018 989.695L763.76 998.543L794.737 979.006L789.662 969.923Z" fill="#0E0000"/> <path d="M736.898 1004.51L704.058 1022.22L709.224 1031.42L741.383 1013.9L736.898 1004.51Z" fill="#0E0000"/> <path d="M683.213 1036.31L649.836 1052.99L654.712 1062.34L687.403 1045.83L683.213 1036.31Z" fill="#0E0000"/> <path d="M628.213 1063.31L594.836 1079.99L599.712 1089.34L632.403 1072.83L628.213 1063.31Z" fill="#0E0000"/> <path d="M517.837 1114.67L483.211 1128.58L487.307 1138.3L521.236 1124.51L517.837 1114.67Z" fill="#0E0000"/> <path d="M464.837 1135.67L430.211 1149.58L434.307 1159.3L468.236 1145.51L464.837 1135.67Z" fill="#0E0000"/> <path d="M415.837 1154.67L379 1167.5V1179.5L419.236 1164.51L415.837 1154.67Z" fill="#0E0000"/> <path d="M571.213 1090.31L537.836 1106.99L542.712 1116.34L575.403 1099.83L571.213 1090.31Z" fill="#0E0000"/> <path d="M857.986 460.232L883.505 487.453L891.076 480.109L865.916 453.496L857.986 460.232Z" fill="#0E0000"/> <path d="M741.128 399.493L776.632 410.969L779.704 400.879L744.809 389.761L741.128 399.493Z" fill="#0E0000"/> <path d="M677.111 418.817C522.129 145.413 33.1434 168.651 2.11145 511.317C-0.389311 538.931 2.11145 582.317 2.11145 582.317C16.6646 818.79 152.288 952.923 302.952 1101.93C318.55 1117.36 334.309 1132.94 350.111 1148.82C359.644 1158.39 368.611 1179.32 368.611 1179.32C368.611 1179.32 370.877 1185.51 374.111 1185.82C376.646 1186.06 378.611 1184.82 379.611 1182.32C380.611 1179.82 380.146 1174.06 379.611 1168.82C379.107 1163.86 377.111 1156.32 377.111 1156.32C392.678 1149.88 408.46 1143.99 424.239 1138.09L424.241 1138.09C448.91 1128.87 473.57 1119.65 497.384 1108.4L498.611 1107.82C503.552 1105.48 508.507 1103.18 513.462 1100.89L513.476 1100.88C525.757 1095.19 538.032 1089.5 550.053 1083.25L550.057 1083.24L550.067 1083.24C556.964 1079.65 563.886 1076.06 570.822 1072.47C670.47 1020.84 773.158 967.633 850.611 884.956C997.465 728.197 917.074 439.93 729.111 414.817C720.56 413.674 706.111 413.317 706.111 413.317M677.111 418.817C691.611 412.817 706.111 413.317 706.111 413.317M677.111 418.817L706.111 413.317M579.111 468.317C511.527 326.666 304.858 287.982 191 397C165.129 421.771 144.25 464.33 138.5 499C107.907 683.449 194.313 881.553 305.611 1025.82C331.293 1059.1 377.111 1102.46 377.111 1102.46C391.19 1100.79 412.111 1092.82 412.111 1092.82C419.518 1089.32 427.072 1085.78 434.746 1082.18C578.638 1014.67 764.848 927.317 813.611 769.317L813.89 768.415C825.376 731.209 826.222 695.616 818.611 657.456C813.186 630.252 800.415 604.191 778.611 586.456L777.735 585.743C756.339 568.329 729.991 551.145 701.111 554.317V563.817C700.08 641.931 677.017 713.843 633.611 778.317L632.854 779.443C605.71 819.769 572.761 851.885 532.027 877.93C503.251 897.115 471.87 910.296 440.416 923.509C422.345 931.1 404.251 938.701 386.611 947.456C327.447 900.06 278.142 844.399 256.111 770.956C256.111 770.956 250.401 738.784 250.111 717.956C249.782 694.216 250.028 680.406 256.111 657.456C256.233 656.997 256.353 656.543 256.473 656.092L256.809 654.82C262.039 635.045 265.171 623.202 276.111 605.456C306.668 555.888 365.081 528.061 422.333 549.208C428.077 551.329 436.061 557.17 444.721 563.505C464.907 578.273 488.764 595.726 496.473 575.016L496.722 574.347C512.998 530.824 543.807 497.464 579.111 468.317ZM579.111 468.317C580.168 463.827 588.111 461.317 588.111 461.317M588.111 461.317C588.111 461.317 573.404 435.295 562.111 420.817C539.143 391.371 517.054 373.55 490.611 357.317C375.94 286.922 186.956 318.418 138.5 457.5C137.735 459.695 137.013 461.756 136.332 463.704C127.821 488.007 125.52 494.577 123 523.485C107.002 706.982 180.822 879.007 285.111 1025.82C276.097 1013.24 265.765 1003.16 254.824 992.486C244.593 982.506 233.829 972.007 223.111 958.456C189.602 916.083 150.111 840.956 150.111 840.956M588.111 461.317C588.111 461.317 596.14 454.294 610.111 446.817M610.111 446.817C613.394 445.06 616.955 442.957 620.71 440.739C626.94 437.06 633.703 433.066 640.611 429.817M610.111 446.817L640.611 429.817M640.611 429.817C645.637 427.454 650.919 425.634 655.47 424.066C658.908 422.882 661.93 421.841 664.111 420.817C523.324 165.783 104.863 223.431 86.6401 523.485L86.6115 523.956C80.6017 622.898 94.3234 713.513 134.111 803.817M134.111 803.817C134.111 803.817 145.62 828.849 150.111 840.956M134.111 803.817L150.111 840.956M877 313.5C877 355.198 842.078 389 799 389C755.922 389 721 355.198 721 313.5C721 271.803 755.922 238 799 238C842.078 238 877 271.803 877 313.5ZM757 138.5C757 214.439 694.768 276 618 276C541.232 276 479 214.439 479 138.5C479 62.5609 541.232 1 618 1C694.768 1 757 62.5609 757 138.5ZM596.5 568.5L598.5 576.5C630.468 706.855 525.409 834.329 403.5 866C382.07 846.692 355.924 823.062 342.5 797C315.594 744.766 313.38 655.108 358.5 614.5C389.487 586.612 412.944 608.298 436.601 630.168C445.089 638.016 453.603 645.887 462.5 651.5C467.913 654.915 474.288 653.336 480 651.5C486.578 649.386 492 638.5 492 638.5C492 638.5 495.023 632.571 500.5 625.5C524.408 594.635 558.048 576.158 596.5 568.5ZM804 421.5L835.5 441.5L841 432.5L810 413L804 421.5ZM660.5 396.076H712.822L712.709 385.529L656 385.529L660.5 396.076ZM898.78 508.414L916.477 541.263L925.676 536.102L908.17 503.934L898.78 508.414ZM925.258 561.364L935.585 597.219L945.669 594.127L935.384 558.977L925.258 561.364ZM938.45 617.398L943.003 654.432L953.448 652.965L948.826 616.635L938.45 617.398ZM942.848 674.296L943.195 711.607L953.738 711.328L953.244 674.708L942.848 674.296ZM941.587 730.139L934.631 766.797L945.026 768.586L951.701 732.576L941.587 730.139ZM931.73 786.392L917.157 820.741L926.936 824.693L941.098 790.919L931.73 786.392ZM908.997 839.146L889.543 870.986L898.636 876.33L917.599 844.999L908.997 839.146ZM877.482 888.093L852.851 916.121L860.892 922.947L884.952 895.336L877.482 888.093ZM835.914 933.029L806.769 956.327L813.495 964.452L842.005 941.464L835.914 933.029ZM789.662 969.923L758.018 989.695L763.76 998.543L794.737 979.006L789.662 969.923ZM736.898 1004.51L704.058 1022.22L709.224 1031.42L741.383 1013.9L736.898 1004.51ZM683.213 1036.31L649.836 1052.99L654.712 1062.34L687.403 1045.83L683.213 1036.31ZM628.213 1063.31L594.836 1079.99L599.712 1089.34L632.403 1072.83L628.213 1063.31ZM517.837 1114.67L483.211 1128.58L487.307 1138.3L521.236 1124.51L517.837 1114.67ZM464.837 1135.67L430.211 1149.58L434.307 1159.3L468.236 1145.51L464.837 1135.67ZM415.837 1154.67L379 1167.5V1179.5L419.236 1164.51L415.837 1154.67ZM571.213 1090.31L537.836 1106.99L542.712 1116.34L575.403 1099.83L571.213 1090.31ZM857.986 460.232L883.505 487.453L891.076 480.109L865.916 453.496L857.986 460.232ZM741.128 399.493L776.632 410.969L779.704 400.879L744.809 389.761L741.128 399.493Z" stroke="black"/> </svg>
            </NuxtLink>
            <nav>
                <ul class="desktop">
                    <li>
                        <NuxtLink to="/">Главная</NuxtLink>
                    </li>
                    <li>
                        <NuxtLink to="/program">Программы</NuxtLink>
                    </li>
                    <li>
                        <NuxtLink to="/group">Набор</NuxtLink>
                    </li>
                    <li>
                        <NuxtLink @click="inDev">Войти</NuxtLink>
                    </li>
                </ul>
                <ul class="mobile">
                    <li>
                        <button class="burger-menu" @click="toggleMobileMenu">
                            <svg v-if="!mobileMenuIsOpen" viewBox="0 0 50 50">
                                <path d="M 0 9 L 0 11 L 50 11 L 50 9 Z M 0 24 L 0 26 L 50 26 L 50 24 Z M 0 39 L 0 41 L 50 41 L 50 39 Z" ></path>
                            </svg>
                            <svg v-if="mobileMenuIsOpen" viewBox="0 0 50 50">
                                <path d="M 7.71875 6.28125 L 6.28125 7.71875 L 23.5625 25 L 6.28125 42.28125 L 7.71875 43.71875 L 25 26.4375 L 42.28125 43.71875 L 43.71875 42.28125 L 26.4375 25 L 43.71875 7.71875 L 42.28125 6.28125 L 25 23.5625 Z" ></path>
                            </svg>
                        </button>
                    </li>
                </ul>
            </nav>
        </ContainerComponent>
        <Transition>
            <div v-if="mobileMenuIsOpen" class="mobile-menu">
                <ul>
                    <li>
                        <NuxtLink to="/" @click="toggleMobileMenu">Главная</NuxtLink>
                    </li>
                    <li>
                        <NuxtLink to="/program" @click="toggleMobileMenu">Программы</NuxtLink>
                    </li>
                    <li>
                        <NuxtLink to="/group" @click="toggleMobileMenu">Набор</NuxtLink>
                    </li>
                    <li>
                        <NuxtLink @click="inDev">Войти</NuxtLink>
                    </li>
                </ul>
            </div>
        </Transition>
    </header>
</template>
<style lang="scss" scoped>
.header {
    height: 90px;
    padding: 10px 0;
    position: fixed;
    width: 100%;
    z-index: 5;
    top: 0;
    transition: var(--transition);

    :deep(.logo){
        :nth-child(1),
        :nth-child(2), 
        :nth-child(3), 
        :nth-child(4),
        :nth-child(5),
        :nth-child(6),
        :nth-child(7),
        :nth-child(8),
        :nth-child(9),
        :nth-child(10),
        :nth-child(11),
        :nth-child(12),
        :nth-child(13),
        :nth-child(14),
        :nth-child(15),
        :nth-child(16),
        :nth-child(17),
        :nth-child(18),
        :nth-child(19),
        :nth-child(20),
        :nth-child(21),
        :nth-child(22),
        :nth-child(23),
        :nth-child(24){
            fill: var(--white);
            stroke: var(--white);
            transition: var(--transition);
        }
    }

    &.black {
        background-color: var(--gray);
        border-bottom: 1px solid var(--pink);
        :deep(.logo){
            :nth-child(1),
            :nth-child(2), 
            :nth-child(3), 
            :nth-child(4),
            :nth-child(5),
            :nth-child(6),
            :nth-child(7),
            :nth-child(8),
            :nth-child(9),
            :nth-child(10),
            :nth-child(11),
            :nth-child(12),
            :nth-child(13),
            :nth-child(14),
            :nth-child(15),
            :nth-child(16),
            :nth-child(17),
            :nth-child(18),
            :nth-child(19),
            :nth-child(20),
            :nth-child(21),
            :nth-child(22),
            :nth-child(23),
            :nth-child(24){
                fill: var(--black);
                stroke: var(--black);
                transition: var(--transition);
            }
        }

        .container {
            nav {
                ul {
                    li {
                        a {
                            color: var(--black);
                        }
                        button.burger-menu {
                            svg {
                                fill: var(--black)
                            }
                        }
                    }
                }
            }
        }

        .mobile-menu {
            background-color: var(--white-opacity);

            ul {
                li {
                    a {
                        color: var(--black);
                    }
                }
            }
        }
    }

    :deep(.logo){
        width: 62px;
        height: 70px;
        vertical-align: middle;
        path {
            stroke: transparent;
        }
    }

    .container {
        display: flex;
        justify-content: space-between;
        align-items: center;

        nav {
            width: 100%;
            margin-left: 20px;

            ul {
                display: flex;
                gap: 15px;
                list-style-type: none;
                margin: 0;
                padding: 0;
                &.mobile {
                    display: none;
                }

                li {
                    a {
                        text-decoration: none;
                        transition: var(--transition);
                        color: var(--white);
                        cursor: pointer;
                    }

                    a.router-link-active {
                        color: var(--pink);
                    }
                    button.burger-menu {
                        background-color: transparent;
                        border: 0;
                        cursor: pointer;
                        padding: 0;
                        svg {
                            width: 25px;
                            height: 25px;
                            fill: var(--white);
                        }
                    }
                }

                & :last-child {
                    margin-left: auto;
                }
            }
        }
    }

    .mobile-menu {  
        position: absolute;
        width: 100%;
        height: 50px;
        top: 58px;
        left: 0;
        background-color: var(--black-opacity);

        ul {
            height: 100%;
            list-style-type: none;
            margin: 0;
            padding: 0 15px;
            display: flex;
            align-items: center;
            li {
                margin-right: 10px;

                a {
                    text-decoration: none;
                    color: var(--white);

                }
                a.router-link-active {
                    color: var(--pink);
                }

                &:last-child {
                    margin-right: 0;
                    margin-left: auto;
                }
            }
        }
    }
}

@include breakpoint(xs) {
    .header {
        height: 60px;
        .logo {
            height: 40px;
            width: 36px;
        }

        .container {
            nav {
                ul {
                    &.mobile {
                        display: flex;
                    }
                    &.desktop {
                        display: none;
                    }
                }
            }
        }
    }
}

.v-enter-active,
.v-leave-active {
    transition: opacity 0.3s ease;
}

.v-enter-from,
.v-leave-to {
    opacity: 0;
}
</style>
